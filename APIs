import json    
import boto3
import ast
import io
import csv
import hashlib
region = 'eu-west-2'
# Initialize dynamodb resource
dynamodb = boto3.resource('dynamodb', region_name=region)
    
    
def insert_dynamoDB_items(tablename: str):
    """
    Insert items to a dynamodb table.
    Arguments:
    - tablename: name of the dynamodb table where items will be inserted
    - items: list of elements that will be added to the dynamodb table
    """
    
    ddb = dynamodb.Table(tablename)
    hash_object = hashlib.sha256()
    hash_object.update(ddb.password.encode())
    hash_password = hash_object.hexdigest()
    ddb.put_item(
        Item={
        'DonorID': "51243715",
        'email': "ruba@idktest.com",
        'password': hash_password
        }
    )
    
    body = json.dumps("SUCCEEDEDDDD")
    res = {
        "statusCode": 200,
        "headers": {
            "Content-Type": "application/json"
        },
        "body": body
    }
    
    return res
def read_dynamoDB_items(tablename: str, key: str):
    """
    Reads item from dynamodb table.
    Arguments:
    - tablename: name of the dynamodb table where items will be inserted
    - key: primary key of the item
    """
    ddb = dynamodb.Table(tablename)
    # FIGURE OUT HOW TO READ
    ress=ddb.get_item(
        Key={
            'DonorID':key
        }
    )
    if 'Item' in ress:
        item = ress['Item']
        return {
            "statusCode": 200,
            "headers": {
                "Content-Type": "application/json"
            },
            "body": json.dumps(item)
        }
    else:
        return {
            "statusCode": 404,
            "headers": {
                "Content-Type": "application/json"
            },
            "body": json.dumps("Item not found")
        }
def update_dynamoDB_items(tablename: str, key: str, email: str, password: str):
    ddb=dynamodb.Table(tablename)
    hash_object = hashlib.sha256()
    hash_object.update(password.encode())
    hash_password = hash_object.hexdigest()
    ress=ddb.update_item(
        Key={
            'DonorID': key,
            'email': email,
            'password': hash_password
        },
        UpdateExpression="set email = :e, password =:p",
        ExpressionAttributeValues={
            ':e': email,
            ':p': hash_password
        },
        ReturnValues="UPDATED_NEW"
    )
    return ress
def lambda_handler(event, context):
    res = read_dynamoDB_items('Donors','51243715')
    return res
